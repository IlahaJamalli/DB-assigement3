CREATE TABLE unnormalizedform(
    CRN INT,
    ISBN VARCHAR(13),
    Title VARCHAR(255),
    Authors VARCHAR(255),
    Edition VARCHAR(50),
    Publisher VARCHAR(255),
    Publisher_Address VARCHAR(255),
    Pages INT,
    Year INT,
    Course_Name VARCHAR(255)
);
\COPY unnormalizedform FROM 'C:\Users\User\database.csv' DELIMITER ',' CSV HEADER;
select * from public.unnormalizedform

CREATE TABLE FistNfTable (
    CRN INT,
    ISBN VARCHAR(13),
    Title VARCHAR(255),
    Author VARCHAR(255),
    Edition VARCHAR(50),
    Publisher VARCHAR(255),
    Publisher_address text,
    Pages INT,
    Year INT,
    Course_Name VARCHAR(255)
);

INSERT INTO FistNfTable (CRN, ISBN, Title, Author, Edition, Publisher,Publisher_address, Pages, Year, Course_Name)
SELECT CRN, ISBN, Title, unnest(string_to_array(Authors, ',')), Edition, Publisher,Publisher_address, Pages, Year, Course_Name
FROM unnormalizedform

select * from public.fistnftable


CREATE TABLE SecondNfCourses(
    CRN INT,
    Course_Name VARCHAR(255),
    PRIMARY KEY (CRN)
);

INSERT INTO SecondNfCourses(CRN, Course_Name) SELECT DISTINCT CRN, Course_Name FROM unnormalizedform
select * from public.secondnfcourses

CREATE TABLE SecondNfBooks(
    ISBN VARCHAR(13),
    Title VARCHAR(255),
    Edition VARCHAR(50),
    Publisher VARCHAR(255),
    Publisher_address TEXT,
    Pages INT,
    Year INT,
    PRIMARY KEY (ISBN)
);

INSERT INTO SecondNfBooks(ISBN, Title, Edition, Publisher, Publisher_address, Pages, Year)
SELECT DISTINCT ISBN, Title, Edition, Publisher, Publisher_address, Pages, Year FROM FistNfTable;

SELECT * FROM public.secondnfbooks

CREATE TABLE SecondNfAuthors AS 
SELECT DISTINCT Author AS Author_Name FROM FistNfTable;

ALTER TABLE SecondNfAuthors ADD Author_ID SERIAL PRIMARY KEY;

SELECT * FROM public.secondnfauthors


CREATE TABLE SecondNf_Book_Authors AS
SELECT DISTINCT 
    FistNfTable.ISBN,
    SecondNfAuthors.Author_ID
FROM FistNfTable
JOIN SecondNfAuthors ON FistNfTable.author = SecondNfAuthors.author_name;

SELECT * FROM public.secondnf_book_authors

CREATE TABLE SecondNf_Course_Books AS
SELECT DISTINCT 
    FistNfTable.ISBN,
    SecondNfCourses.CRN
FROM FistNfTable
JOIN SecondNfCourses ON FistNfTable.course_name = SecondNfCourses.course_name;

SELECT * FROM public.secondnf_course_books









